1. https://huggingface.co/google/siglip2-so400m-patch14-384 —ç—Ç–æ –ø–æ –∏–¥–µ–µ –ª—É—á—à–∏–π –∫–ª–∏–ø
2. csv —á–∞—Å—Ç—è–º–∏:
```python
import pandas as pd
# Process the CSV file in chunks of 10,000 rows
for chunk in pd.read_csv('your_file.csv', chunksize=10000):
    # Perform operations on each chunk
    print(f"Processing chunk with {len(chunk)} rows.")
```
3. text embedders:
* deepvk/USER-bge-m3
* cointegrated/rubert-tiny2
* cointegrated/LaBSE-en-ru
* ai-forever/ru-en-RoSBERTa
4. –ï—â—ë –∫–æ–≥–¥–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–æ—Ä–æ–π —Ö–æ—Ä–æ—à–æ –¥–∞–µ—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∞ —Ç–∞—Ä–≥–µ—Ç–∞ –∫–æ–≥–¥–∞ —É—á–∏—à—å –Ω–µ–π—Ä–æ–Ω–∫—É
5. –ª–ª–º–æ—á–∫–∏
* IlyaGusev/saiga_yandexgpt_8b
* t-tech/T-lite-it-1.0
* AvitoTech/avibe (—Ö–∑ –Ω–µ –∏–≥—Ä–∞–ª)
* qwen—á–∏–∫–∏

# –ì–ü–¢ –•–†–ï–ù–¨

# –ü—Ä–æ–º–ø—Ç 1

–°–≤–æ–¥–∫–∞ –∏–¥–µ–∏:
—Ç—ã —É–∂–µ –¥–µ–ª–∞–µ—à—å –æ—á–µ–Ω—å —Ä–∞–∑—É–º–Ω—ã–π –±–µ–π–∑–ª–∞–π–Ω ‚Äî CatBoost –ø–æ —Ç–∞–±–ª–∏—á–∫–µ + —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫. –î–∞–ª—å—à–µ —É–ª—É—á—à–µ–Ω–∏—è –æ–±—ã—á–Ω–æ –∏–¥—É—Ç –ø–æ —Ç—Ä—ë–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º:

1. **–°–¥–µ–ª–∞—Ç—å —Å–∞–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –ª—É—á—à–µ.**
2. **–ù–∞—É—á–∏—Ç—å—Å—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å *–Ω–µ—Å–∫–æ–ª—å–∫–æ* –∫–∞—Ä—Ç–∏–Ω–æ–∫ (–Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ).**
3. **–ü–æ–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π NN (–∏–ª–∏ –∑–∞—ç–Ω—Å–µ–º–±–ª–∏—Ç—å —Å CatBoost).**

–†–∞–∑–±–µ—Ä—ë–º –ø–æ –ø–æ—Ä—è–¥–∫—É.

---

## 1. –£–ª—É—á—à–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫

–¢–æ, —á—Ç–æ —Ç—ã —Å–µ–π—á–∞—Å –¥–µ–ª–∞–µ—à—å (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ):

* –±–µ—Ä—ë—à—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä (ResNet / EfficientNet / ViT / CLIP),
* —Å—á–∏—Ç–∞–µ—à—å —ç–º–±–µ–¥–¥–∏–Ω–≥ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏,
* —É—Å—Ä–µ–¥–Ω—è–µ—à—å,
* –ø—Ä–∏–∫–ª–µ–∏–≤–∞–µ—à—å –∫ —Ç–∞–±–ª–∏—á–Ω—ã–º —Ñ–∏—á–∞–º ‚Üí CatBoost.

–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –±–µ–∑ —Å–º–µ–Ω—ã –æ–±—â–µ–π —Å—Ö–µ–º—ã:

### 1.1. –î–æ–º–µ–Ω–Ω—ã–π fine-tuning —ç–Ω–∫–æ–¥–µ—Ä–∞

1. –ë–µ—Ä—ë—à—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
2. –ü–æ–≤–µ—Ä—Ö –Ω–µ–≥–æ —Å—Ç–∞–≤–∏—à—å –Ω–µ–±–æ–ª—å—à–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π head (–ª–∏–Ω–µ–π–∫–∞ / MLP).
3. –í –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—ä–µ–∫—Ç–æ–≤ ‚Äî **–æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏**, —Ç–∞—Ä–≥–µ—Ç —Ç–æ—Ç –∂–µ, —á—Ç–æ —É –∑–∞–ø–∏—Å–∏ (–¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∑–∞–ø–∏—Å–∏).
4. –û–±—É—á–∞–µ—à—å: –ª–∏–±–æ

   * –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä + –æ–±—É—á–∞–µ–º—ã–π head, –ª–∏–±–æ
   * —Ä–∞–∑–º–æ—Ä–∞–∂–∏–≤–∞–µ—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Ö–Ω–∏—Ö —Å–ª–æ—ë–≤.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ:

* —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∑–∞—Ç–æ—á–µ–Ω–Ω—ã–º–∏ –ø–æ–¥ —Ç–≤–æ—é –∑–∞–¥–∞—á—É;
* CatBoost —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Å ¬´—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º–∏¬ª —Ñ–∏—á–∞–º–∏, –∞ —Å ¬´–∑–∞–¥–∞—á–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º–∏¬ª.

### 1.2. –ë–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π pooling –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º

–°—Ä–µ–¥–Ω–µ–µ ‚Äî –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ:

* **Max-pooling** –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º (–∏–Ω–æ–≥–¥–∞ –ª—É—á—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ).
* **Concat([mean, max])** ‚Üí –¥–∞—ë—Ç –≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –Ω–æ —Ö—Ä–∞–Ω–∏—Ç –±–æ–ª—å—à–µ –∏–Ω—Ñ—ã.
* **Attention pooling** (—Å–º. –Ω–∏–∂–µ –≤ —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—å; –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å offline –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —É–∂–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫).

–î–∞–∂–µ –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ `mean` –∫ `mean+max` –∏–ª–∏ –Ω–µ–±–æ–ª—å—à–æ–π attention-–∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –¥–∞—Ç—å +–æ—á–∫–∏ –∫ –º–µ—Ç—Ä–∏–∫–µ –ø—Ä–∏ —Ç–æ–π –∂–µ CatBoost-—Å—Ö–µ–º–µ.

---

## 2. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏

–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç: —É —Ç–µ–±—è –µ—Å—Ç—å **set** –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–∞ –æ–¥–Ω—É –∑–∞–ø–∏—Å—å. –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤.

### 2.1. Multiple Instance Learning (MIL) / DeepSets-—Å—Ç–∏–ª—å

–ò–¥–µ—è: –º–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç **–≤—Å–µ** –∫–∞—Ä—Ç–∏–Ω–∫–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∏ —Å–∞–º–∞ —É—á–∏—Ç—Å—è, –∫–∞–∫–∏–µ –≤–∞–∂–Ω–µ–µ.

–°—Ö–µ–º–∞:

1. –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ `i` —Å—á–∏—Ç–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥ `e_i`.

2. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ –º–∞–ª–µ–Ω—å–∫–∏–π attention-–º–æ–¥—É–ª—å:

   [
   \alpha_i = \text{softmax}(w^T \cdot \tanh(W e_i))
   ]
   [
   e_{\text{agg}} = \sum_i \alpha_i e_i
   ]

3. `e_agg` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ ¬´—ç–º–±–µ–¥–¥–∏–Ω–≥ –Ω–∞–±–æ—Ä–∞¬ª.

–≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

* –∏–ª–∏ **–≤–Ω—É—Ç—Ä–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏** (—Å–º. —Ä–∞–∑–¥–µ–ª 3),
* –∏–ª–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—É—é –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞—ë—Ç `e_agg` offline, –∞ –ø–æ—Ç–æ–º —Ç—ã –µ–≥–æ —Å–∫–∞—Ä–º–ª–∏–≤–∞–µ—à—å CatBoost‚Äô—É –∫–∞–∫ —Ñ–∏—á—É.

### 2.2. –¢—Ä–∞–∫—Ç–æ–≤–∞—Ç—å (–∑–∞–ø–∏—Å—å, –∫–∞—Ä—Ç–∏–Ω–∫–∞) –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

–ë—ã—Å—Ç—Ä—ã–π —Ç—Ä—é–∫:

* –ö–∞–∂–¥—É—é (–∑–∞–ø–∏—Å—å, –∫–∞—Ä—Ç–∏–Ω–∫–∞) —Å—á–∏—Ç–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π –≤ —Ç—Ä–µ–π–Ω-—Å–µ—Ç–µ.
* –¢–∞—Ä–≥–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ.
* –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–µ + —Ç–∞–±–ª–∏—á–∫–µ.
* –ù–∞ inference –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ —É —Ç–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫ ‚Üí —É—Å—Ä–µ–¥–Ω—è–µ—à—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏.

–ü–ª—é—Å—ã:

* –ø—Ä–æ—Å—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å;
* –¥–∞—ë—Ç –º–æ–¥–µ–ª–∏ –±–æ–ª—å—à–µ –æ–±—É—á–∞—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

–ú–∏–Ω—É—Å—ã:

* —Ç–∞—Ä–≥–µ—Ç –ø–æ —Å—É—Ç–∏ ¬´—à—É–º–Ω–æ¬ª —Ä–∞–∑–º–∞–∑–∞–Ω –º–µ–∂–¥—É –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ (–Ω–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—Å—Ç–æ –Ω–æ—Ä–º).

–≠—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —Å CatBoost (–¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—á–∫—É –Ω–∞ –∫–∞–∂–¥—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É), –∏ —Å NN.

---

## 3. –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å (Vision + Tabular)

–ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —É–π—Ç–∏ –æ—Ç ¬´—á–∏—Å—Ç–æ CatBoost + —Ñ–∏—á–∏¬ª, —Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

1. **Image encoder** (ResNet / EfficientNet / ViT / CLIP encoder, –º–æ–∂–Ω–æ —Å fine-tuning).
2. **Image set encoder**: attention / DeepSets pooling –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–∞—Ä—Ç–∏–Ω–∫–∞–º.
3. **Tabular encoder**: MLP / Transformer –ø–æ —Ç–∞–±–ª–∏—á–Ω—ã–º —Ñ–∏—á–∞–º.
4. **Fusion**: –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∏–ª–∏ cross-attention.
5. **Regressor head** (MLP ‚Üí —Å–∫–∞–ª—è—Ä–Ω—ã–π —Ç–∞—Ä–≥–µ—Ç).

### 3.1. –°—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–£—Å–ª–æ–≤–Ω—ã–π PyTorch-—Å–∫–µ–ª–µ—Ç (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π, –Ω–æ —á–∏—Ç–∞–µ–º—ã–π):

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
from torchvision.models import resnet18

class ImageEncoder(nn.Module):
    def __init__(self, out_dim=256, pretrained=True):
        super().__init__()
        backbone = resnet18(weights="DEFAULT" if pretrained else None)
        self.features = nn.Sequential(*list(backbone.children())[:-1])  # [B, 512, 1, 1]
        self.proj = nn.Linear(512, out_dim)
    
    def forward(self, x):
        # x: [B, 3, H, W]
        h = self.features(x)          # [B, 512, 1, 1]
        h = h.view(h.size(0), -1)     # [B, 512]
        h = self.proj(h)              # [B, out_dim]
        return h

class AttentionPooling(nn.Module):
    def __init__(self, dim):
        super().__init__()
        self.attn = nn.Linear(dim, 1)
    
    def forward(self, x, mask=None):
        """
        x: [B, N, D] ‚Äî N –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–∞ –æ–±—ä–µ–∫—Ç
        mask: [B, N] ‚Äî 1 –µ—Å–ª–∏ –µ—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∞, 0 –µ—Å–ª–∏ –ø–∞–¥–¥–∏–Ω–≥
        """
        scores = self.attn(torch.tanh(x)).squeeze(-1)  # [B, N]
        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)
        weights = F.softmax(scores, dim=-1)            # [B, N]
        pooled = torch.sum(x * weights.unsqueeze(-1), dim=1)  # [B, D]
        return pooled

class TabularEncoder(nn.Module):
    def __init__(self, in_dim, hidden_dim=256, out_dim=128):
        super().__init__()
        self.net = nn.Sequential(
            nn.Linear(in_dim, hidden_dim),
            nn.ReLU(),
            nn.BatchNorm1d(hidden_dim),
            nn.Linear(hidden_dim, out_dim),
            nn.ReLU(),
        )
    def forward(self, x):
        return self.net(x)

class MultiModalRegressor(nn.Module):
    def __init__(self, tabular_dim, img_emb_dim=256, hidden_dim=256):
        super().__init__()
        self.img_encoder = ImageEncoder(out_dim=img_emb_dim)
        self.img_pool = AttentionPooling(img_emb_dim)
        self.tab_encoder = TabularEncoder(tabular_dim)
        self.head = nn.Sequential(
            nn.Linear(img_emb_dim + 128, hidden_dim),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(hidden_dim, 1)
        )
    
    def forward(self, tabular_features, images, img_mask=None):
        """
        tabular_features: [B, F]
        images: [B, N, 3, H, W]
        img_mask: [B, N]
        """
        B, N, C, H, W = images.shape
        images = images.view(B * N, C, H, W)
        img_emb = self.img_encoder(images)              # [B*N, D]
        img_emb = img_emb.view(B, N, -1)               # [B, N, D]

        img_agg = self.img_pool(img_emb, img_mask)     # [B, D]
        tab_emb = self.tab_encoder(tabular_features)   # [B, 128]
        fused = torch.cat([img_agg, tab_emb], dim=-1)
        out = self.head(fused).squeeze(-1)
        return out
```

–û–±—É—á–∞–µ—à—å –æ–±—ã—á–Ω—ã–º MSE/RMSE-–ª–æ—Å—Å–æ–º.
–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

* **img_mask** –¥–ª—è —Ä–∞–∑–Ω–æ–≥–æ —á–∏—Å–ª–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–∞ –∑–∞–ø–∏—Å—å (–ø–∞–¥–¥–∏—à—å –æ—Ç—Å—É—Ç—Å–≤—É—é—â–∏–µ).
* –ú–æ–∂–Ω–æ –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å `ImageEncoder` –Ω–∞ –ø–µ—Ä–≤—ã—Ö —ç–ø–æ—Ö–∞—Ö, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –±—ã—Å—Ç—Ä–µ–µ —É—á–∏–ª–∞—Å—å –ø–æ —Ç–∞–±–ª–∏—á–∫–µ.

---

## 4. –ö–æ–º–±–∏–Ω–∞—Ü–∏—è CatBoost + NN (—ç–Ω—Å–µ–º–±–ª–∏)

–ß–∞—Å—Ç–æ –ª—É—á—à–∏–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:

1. –û–±—É—á–∞–µ—à—å **CatBoostRegressor** –Ω–∞ —Ç–∞–±–ª–∏—á–∫–µ + ¬´–ø—Ä–æ—Å—Ç—ã–µ¬ª —ç–º–±–µ–¥–¥–∏–Ω–≥–∏/–∞–≥—Ä–µ–≥–∞—Ç—ã –∫–∞—Ä—Ç–∏–Ω–æ–∫.
2. –û–±—É—á–∞–µ—à—å **–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä** (–∫–∞–∫ –≤—ã—à–µ).
3. –ù–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–¥–±–∏—Ä–∞–µ—à—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å `w` –≤:

   [
   \hat{y} = w \cdot \hat{y}*{\text{catboost}} + (1 - w) \cdot \hat{y}*{\text{nn}}
   ]

–ß–∞—Å—Ç–æ –¥–∞—ë—Ç +1‚Äì3% –∫ –º–µ—Ç—Ä–∏–∫–µ ¬´–ø—Ä–æ—Å—Ç–æ —Ç–∞–∫¬ª, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–µ–ª–∏ –ª–æ–≤—è—Ç —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –¥–∞–Ω–Ω—ã—Ö.

---

## 5. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

**CV –∏ —É—Ç–µ—á–∫–∏:**

* –ï—Å–ª–∏ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å = –æ–¥–∏–Ω —Ç–∞—Ä–≥–µ—Ç –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫, **–Ω–µ –¥–µ–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –º–µ–∂–¥—É —Ñ–æ–ª–¥–∞–º–∏**. –î–µ–ª–∏—Ç—å –Ω—É–∂–Ω–æ –ø–æ –∑–∞–ø–∏—Å–∏ (id –æ–±—ä–µ–∫—Ç–∞), —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —É—Ç–µ—á–∫–∏.

**–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:**

* –î–ª—è NN —Ç–∞–±–ª–∏—á–Ω—ã–µ —Ñ–∏—á–∏ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å (StandardScaler / MinMax).
* –î–ª—è CatBoost –Ω–∞–æ–±–æ—Ä–æ—Ç –Ω–µ –Ω—É–∂–Ω–æ, CatBoost —Å–∞–º —Å–ø—Ä–∞–≤–∏—Ç—Å—è.

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**

* –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –æ—Å—Ç–∞—Ç—å—Å—è —Å CatBoost –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—ã–º, –ª–æ–≥–∏—á–Ω–æ:

  * CatBoost –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ ¬´–Ω–∞—Ç–∏–≤–Ω–æ¬ª,
  * NN –±–æ–ª—å—à–µ –ª—é–±–∏—Ç —É–∂–µ —ç–Ω–∫–æ–¥–Ω—É—Ç—ã–µ (Target encoding / embeddings) ‚Äî –Ω–æ —ç—Ç–æ –±–æ–ª—å—à–µ –≤–æ–∑–Ω–∏.

---

### –ï—Å–ª–∏ –∫—Ä–∞—Ç–∫–æ: –ø–ª–∞–Ω –∞–ø–≥—Ä–µ–π–¥–∞ –±–µ–π–∑–ª–∞–π–Ω–∞

1. **–ó–∞–º–µ–Ω–∏—Ç—å mean-–ø—É–ª–∏–Ω–≥ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º –Ω–∞ —á—Ç–æ-—Ç–æ —É–º–Ω–µ–µ**:

   * —Ö–æ—Ç—è –±—ã `concat(mean, max)`,
   * –ª—É—á—à–µ attention pooling (DeepSets/MIL).
2. **–§–∞–π–Ω—Ç—é–Ω–∏—Ç—å —ç–Ω–∫–æ–¥–µ—Ä –∫–∞—Ä—Ç–∏–Ω–æ–∫ –ø–æ–¥ —Ç–∞—Ä–≥–µ—Ç** (–¥–∞–∂–µ –ª—ë–≥–∫–∏–π fine-tuning –¥–∞—ë—Ç –æ—â—É—Ç–∏–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç).
3. **–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π NN** —Å attention-–ø—É–ª–∏–Ω–≥–æ–º –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º.
4. **–°–¥–µ–ª–∞—Ç—å –∞–Ω—Å–∞–º–±–ª—å CatBoost + NN**.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –º–æ–≥—É –ø–æ–º–æ—á—å:

* –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø–æ–¥ —Ç–≤–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (–∫–∞–∫–æ–π —Ç–∞—Ä–≥–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫, —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞),
* –Ω–∞–±—Ä–æ—Å–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π PyTorch-—Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –ø–æ–¥ —Ç–≤–æ–π –∫–µ–π—Å.

# –ü—Ä–æ–º–ø—Ç 2

–ù–∞–±—Ä–æ—Å–∞—é –∏–º–µ–Ω–Ω–æ ¬´—Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π¬ª –Ω–∞–±–æ—Ä –ø—Ä–∏—ë–º–æ–≤, –±–µ–∑ –º–æ—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä—Å—Ç–≤–∞ üòä
–ß–∞—Å—Ç—å —É–∂–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç —Ç–æ, —á—Ç–æ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏, –Ω–æ –∑–∞–π–¥—É —à–∏—Ä–µ –∏ –±–æ–ª–µ–µ ¬´–≥—Ä—è–∑–Ω–æ-–ø—Ä–∞–∫—Ç–∏—á–Ω–æ¬ª.

---

## 0. –ú–µ—Ç–∞-—É—Ä–æ–≤–µ–Ω—å: CV –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

1. **–ì—Ä–∞–º–æ—Ç–Ω—ã–π CV ‚Äî –≥–ª–∞–≤–Ω—ã–π –±—É—Å—Ç.**

   * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **GroupKFold** –ø–æ –æ–±—ä–µ–∫—Ç—É (ID –∑–∞–ø–∏—Å–∏), —á—Ç–æ–±—ã –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–µ –ø–æ–ø–∞–¥–∞–ª–∞ –∏ –≤ train, –∏ –≤ val —Ä–∞–∑–Ω—ã–º–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏.
   * –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ ‚Äî **StratifiedKFold –ø–æ –±–∏–Ω–∞–º —Ç–∞—Ä–≥–µ—Ç–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10‚Äì20 –∫–≤–∞–Ω—Ç–∏–ª–µ–π), —á—Ç–æ–±—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Ñ–æ–ª–¥–∞–º –±—ã–ª–∏ –ø–æ—Ö–æ–∂–∏–º–∏.
   * –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ö–µ–º CV (KFold, GroupKFold, TimeSeriesSplit, –µ—Å–ª–∏ –µ—Å—Ç—å –≤—Ä–µ–º—è), –≤—ã–±—Ä–∞—Ç—å —Ç—É, —É –∫–æ—Ç–æ—Ä–æ–π OOF —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å public LB.

2. **–ü–æ–≤–µ—Ä—Ö OOF-–ø—Ä–µ–¥–∏–∫—Ç–æ–≤ —Å–¥–µ–ª–∞—Ç—å –∫–∞–ª–∏–±—Ä–æ–≤–∫—É.**

   * –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è OOF-–ø—Ä–µ–¥–∏–∫—Ç–æ–≤ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –ø–æ–¥–æ–≥–Ω–∞—Ç—å **–ø—Ä–æ—Å—Ç—É—é –ª–∏–Ω–µ–π–Ω—É—é/–ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é**:
     `y_true = a * y_pred + b` –∏–ª–∏ `y_true = a * y_pred + b * y_pred^2 + c`.
     –ù–∞ —Ç–µ—Å—Ç–µ –ø—Ä–∏–º–µ–Ω—è–µ—à—å —É–∂–µ –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ–æ—Ä–º—É.
   * –ò–Ω–æ–≥–¥–∞ –±–∞–Ω–∞–ª—å–Ω–æ–µ ¬´—Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏–µ¬ª –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—ë—Ç –ø—Ä–∏–ª–∏—á–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç.

---

## 1. –ò–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥ —Ç–∞—Ä–≥–µ—Ç–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤

1. **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–∞—Ä–≥–µ—Ç–∞:**

   * –ï—Å–ª–∏ —Ç–∞—Ä–≥–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∏ —Å —Ö–≤–æ—Å—Ç–∞–º–∏ ‚Äî –ª–æ–≥-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è: `y' = log1p(y)`.
     –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å `y'`, –Ω–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ –¥–µ–ª–∞–µ—à—å `exp(y') - 1`.
   * **Box-Cox / Yeo-Johnson** ‚Äî –µ—â—ë –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å, —á–∞—Å—Ç–æ —É–ª—É—á—à–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.

2. **–†–∞–±–æ—Ç–∞ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏:**

   * –ó–∞–∂–∞—Ç—å —Ç–∞—Ä–≥–µ—Ç: `y_clipped = clip(y, p1, p99)` (–∏–ª–∏ –Ω–µ–º–Ω–æ–≥–æ —à–∏—Ä–µ).
     –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ ¬´–∑–∞—â–∏—Ç–∞ –æ—Ç —à—É–º–Ω—ã—Ö –ª–µ–π–±–ª–æ–≤¬ª.
   * –û—Ç–¥–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å **—Ç–æ–ª—å–∫–æ –ø–æ ¬´–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º¬ª –æ–±—ä–µ–∫—Ç–∞–º** (–±–µ–∑ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ç–∞—Ä–≥–µ—Ç–∞), –∞ –ø–æ—Ç–æ–º –∞–Ω—Å–∞–º–±–ª—å —Å –º–æ–¥–µ–ª—å—é –ø–æ –≤—Å–µ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É.

3. **Weighting / sample weights:**

   * –ï—Å–ª–∏ –µ—Å—Ç—å –≤–∞–∂–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã —Ç–∞—Ä–≥–µ—Ç–∞ ‚Äî –º–æ–∂–Ω–æ **–≤–µ—Å–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã** (sample_weight –≤ CatBoost/NN) –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –≤–ª–∏—è–Ω–∏—è —Ä–µ–¥–∫–∏—Ö, —à—É–º–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤.

---

## 2. Feature engineering (—Ç–∞–±–ª–∏—á–∫–∞ + –∫–∞—Ä—Ç–∏–Ω–∫–∞)

### 2.1. –¢–∞–±–ª–∏—á–Ω—ã–µ —Ñ–∏—á–∏

1. **–ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –∏ –∫—Ä–æ—Å—Å-—Ñ–∏—á–∏:**

   * –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å f(x1, x2) = x1 * x2, x1/x2, x1^2, log(x1), sqrt(x1) –∏ —Ç.–ø.
   * –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä—É–∫–∞–º–∏: —Ç–æ–ª—å–∫–æ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏.

2. **–ì—Ä—É–ø–ø–æ–≤—ã–µ –∞–≥–≥—Ä–µ–≥–∞—Ü–∏–∏:**

   * –ï—Å–ª–∏ –µ—Å—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (user_id, product_id, category –∏ —Ç.–¥.), –¥–µ–ª–∞—Ç—å:

     * mean/median/var —Ç–∞—Ä–≥–µ—Ç–∞ –ø–æ –≥—Ä—É–ø–ø–µ (—á–µ—Ä–µ–∑ CV target encoding),
     * count, nunique, ratios –º–µ–∂–¥—É –Ω–∏–º–∏.

3. **Target encoding (CV-safe):**

   * –î–∞–∂–µ —Å CatBoost –∏–º–µ–µ—Ç —Å–º—ã—Å–ª **—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ** –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π target encoding –ø–æ –∫–ª—é—á–µ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–æ—Å–æ–±–µ–Ω–Ω–æ —Ä–µ–¥–∫–∏–º), —Å–æ–±–ª—é–¥–∞—è CV, –∏ –ø–æ–¥–∞—Ç—å —ç—Ç–∏ —Ñ–∏—á–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ.

4. **Rank-—Ñ–∏—á–∏:**

   * –í–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø –∏–ª–∏ –ø–æ –≤—Å–µ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–∞–Ω–≥–∏ / –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏ (rank –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É, rank –ø–æ —Ç–∞—Ä–≥–µ—Ç—É –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã).

### 2.2. –§–∏—á–∏ –∏–∑ –∫–∞—Ä—Ç–∏–Ω–æ–∫ (–ø–æ–º–∏–º–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤)

1. **–ü—Ä–æ—Å—Ç—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø–∏–∫—Å–µ–ª—è–º:**

   * –°—Ä–µ–¥–Ω—è—è —è—Ä–∫–æ—Å—Ç—å, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ, –º–∏–Ω–∏–º—É–º/–º–∞–∫—Å–∏–º—É–º –ø–æ –∫–∞–Ω–∞–ª–∞–º RGB.
   * –û—Ç–Ω–æ—à–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤, –∫–æ–Ω—Ç—Ä–∞—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, std –≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞—Ö).

2. **–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã:**

   * –¶–≤–µ—Ç–æ–≤—ã–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã (–Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∏–Ω–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–∞–Ω–∞–ª—É) ‚Üí —É–∂–∞—Ç—ã–µ –¥–æ 20‚Äì50 —Ñ–∏—á–µ–π.
   * LBP/edge-–¥–µ—Ç–µ–∫—Ç–æ—Ä—ã –∏ –ø—Ä–æ—Å—Ç—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ ¬´—Ç–µ–∫—Å—Ç—É—Ä–Ω–æ—Å—Ç–∏¬ª.

3. **–†–∞–∑–º–µ—Ä/–º–∞—Å—à—Ç–∞–±:**

   * –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä/–º–∞—Å—à—Ç–∞–± –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (–∏–ª–∏ —Ö–æ—Ç—è –±—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ) ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞–∫ —Ñ–∏—á—É.

4. **–§–∏—á–∏ ¬´–∫–∞—á–µ—Å—Ç–≤–∞¬ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**

   * –†–µ–∑–∫–æ—Å—Ç—å (—á–µ—Ä–µ–∑ –≤–∞—Ä–∏–∞—Ü–∏—é –ª–∞–ø–ª–∞—Å–∏–∞–Ω–∞),
   * –ù–∞–ª–∏—á–∏–µ —Å–∏–ª—å–Ω–æ–π –∑–∞—Å–≤–µ—Ç–∫–∏/—Ç—ë–º–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π,
   * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ ¬´—à—É–º–Ω—ã—Ö¬ª –ø–∏–∫—Å–µ–ª–µ–π.

–í —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è—Ö —á–∞—Å—Ç–æ —Ç–∞–∫–∞—è ¬´–ø—Ä–æ—Å—Ç–∞—è —Ñ–∏–∑–∏–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏¬ª –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ –¥–∞—ë—Ç –æ—â—É—Ç–∏–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –≤ –±—É—Å—Ç–∏–Ω–≥–∞—Ö.

---

## 3. –ë–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç—Ä—é–∫–∏ —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏

1. **–ú–Ω–æ–≥–æ —ç–º–±–µ–¥–¥–µ—Ä–æ–≤ ‚Üí –∞–Ω—Å–∞–º–±–ª—å –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ–∏—á–µ–π:**

   * –ü–æ—Å—á–∏—Ç–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Å —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π: ResNet, EfficientNet, ViT, CLIP.
   * –î–ª—è –∫–∞–∂–¥–æ–π: –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º (mean/attention).
   * –ü–æ–¥–∞—Ç—å –≤ CatBoost/NN –∏–ª–∏ –∂–µ:

     * —Å–¥–µ–ª–∞—Ç—å PCA/UMAP –¥–æ 32‚Äì64 –∏–∑–º–µ—Ä–µ–Ω–∏–π,
     * –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å —Ç–∞–±–ª–∏—á–∫–æ–π.

2. **TTA –∏ multi-crop:**

   * –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π (flip, crop, color jitter) –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –∏ –ø–æ—Ç–æ–º —É—Å—Ä–µ–¥–Ω–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.
   * –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç —à—É–º –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–¥—Ä–∞/—Ä–∞–∫—É—Ä—Å–∞.

3. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π pooling –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º:**

   * –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ mean:

     * `e_mean`, `e_max`, `e_min`, `e_std` ‚Üí –∫–æ–Ω–∫–∞—Ç.
   * –í–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ pooling ‚Äî ** –º–∞–ª–µ–Ω—å–∫–∞—è —Å–µ—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ –≤—ã–¥–∞—ë—Ç –∞–≥—Ä–µ–≥–∞—Ç** (attention / DeepSets).

4. **Pretext / auxiliary tasks:**

   * –°–¥–µ–ª–∞—Ç—å –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω—É—é –º–æ–¥–µ–ª—å: –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞—Ä–≥–µ—Ç –∏ –∫–∞–∫–∏–µ-—Ç–æ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–µ (–∫–ª–∞—Å—Å—ã, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, binned target).
   * –¢–∞–∫–∞—è –º—É–ª—å—Ç–∏—Ç–∞—Å–∫–æ–≤–æ—Å—Ç—å —Ö–æ—Ä–æ—à–æ ¬´–≤—ã–ø—Ä—è–º–ª—è–µ—Ç¬ª —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.

---

## 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç—Ä—é–∫–∏ –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏

1. **–°–ª–æ–∂–Ω—ã–µ —Ñ—å—é–∂–Ω-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**

   * –í–º–µ—Å—Ç–æ —Ç—É–ø–æ–≥–æ concatenation:

     * cross-attention –º–µ–∂–¥—É —Ç–∞–±–ª–∏—á–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–æ–º –∏ –Ω–∞–±–æ—Ä–æ–º image-—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤;
     * –º–æ–¥—É–ª—è—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ —Ñ–∏—á–∞–º–∏ (FiLM / gating).

2. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è:**

   * Dropout, weight decay, label noise –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–Ω–µ–º–Ω–æ–≥–æ –∑–∞—à—É–º–ª—è—Ç—å —Ç–∞—Ä–≥–µ—Ç –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏).
   * Mixup/Cutmix **–Ω–∞ —É—Ä–æ–≤–Ω–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤** (–∏–ª–∏ –¥–∞–∂–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫) ‚Üí –ø–æ–º–æ–≥–∞–µ—Ç –µ—â—ë —Å–∏–ª—å–Ω–µ–µ.

3. **–û—Å–æ–±—ã–µ –ª–æ—Å—Å—ã:**

   * Huber / SmoothL1 –≤–º–µ—Å—Ç–æ MSE, –µ—Å–ª–∏ –º–Ω–æ–≥–æ –≤—ã–±—Ä–æ—Å–æ–≤.
   * –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä—É—é –∑–∞–¥–∞—á—É: –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å binned target (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è) + –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –ª–æ—Å—Å.

4. **Snapshot-ensemble / SWA:**

   * –í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ ¬´–ª—É—á—à–∏—Ö¬ª —Å–æ—Å—Ç–æ—è–Ω–∏–π –º–æ–¥–µ–ª–∏ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (—Ä–∞–∑–Ω—ã–µ —ç–ø–æ—Ö–∏, —Ä–∞–∑–Ω—ã–µ lr-—Å—Ö–µ–º—ã).
   * –ù–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ —É—Å—Ä–µ–¥–Ω—è—Ç—å –ø—Ä–µ–¥–∏–∫—Ç—ã —ç—Ç–∏—Ö —Å–Ω–∞–ø—à–æ—Ç–æ–≤.

---

## 5. –ê–Ω—Å–∞–º–±–ª–∏, —Å—Ç–µ–∫–∏–Ω–≥, –±–ª–µ–Ω–¥–∏–Ω–≥

1. **–†–∞–∑–Ω—ã–µ —Å–µ–º–µ–π—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π:**

   * CatBoost (—Ç–∞–±–ª–∏—á–∫–∞ + image-—Ñ–∏—á–∏),
   * LightGBM / XGBoost (—Å —Ç–µ–º–∏ –∂–µ —Ñ–∏—á–∞–º–∏),
   * NN-–º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è,
   * NN —Ç–æ–ª—å–∫–æ –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º,
   * GBM —Ç–æ–ª—å–∫–æ –ø–æ —Ç–∞–±–ª–∏—á–∫–µ.

2. **Stacking:**

   * –ù–∞ CV —Å—Ç—Ä–æ–∏—à—å OOF-–ø—Ä–µ–¥–∏–∫—Ç—ã –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π (CatBoost, LGBM, NN –∏ —Ç.–¥.).
   * –í–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å ‚Äî –ª–∏–±–æ –µ—â—ë –æ–¥–∏–Ω CatBoost/LinearRegression/Ridge, –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—Å—è –ø–æ OOF –∏ —Ç–∞—Ä–≥–µ—Ç—É.
   * –ù–∞ —Ç–µ—Å—Ç–µ –ø–æ–¥–∞–µ—à—å –ø—Ä–µ–¥–∏–∫—Ç—ã base-–º–æ–¥–µ–ª–µ–π –≤ —ç—Ç–æ—Ç –º–µ—Ç–∞-–ª–µ–≤–µ–ª.

3. **Bagging –ø–æ —Å–∏–¥—É –∏ –ø–æ —Ñ–∏—á–∞–º:**

   * –ù–µ—Å–∫–æ–ª—å–∫–æ CatBoost/NN —Å —Ä–∞–∑–Ω—ã–º–∏ seed, —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ —Ñ–∏—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤).
   * –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ–≤ / –º–µ–¥–∏–∞–Ω–∞ / weighted blending:

     * –≤–µ—Å–∞ –ø–æ–¥–±–∏—Ä–∞–µ—à—å –ø–æ OOF (—Ä–µ—à–∞–µ—à—å –ø—Ä–æ—Å—Ç—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é: –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å RMSE –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ –≤–µ—Å–∞–º).

4. **Blending —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∞—Ä–≥–µ—Ç-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏:**

   * –û–±—É—á–∏—Ç—å:

     * –æ–¥–Ω—É –º–æ–¥–µ–ª—å –Ω–∞ `y`,
     * –æ–¥–Ω—É –Ω–∞ `log1p(y)`,
     * –æ–¥–Ω—É –Ω–∞ `sqrt(y)`,
   * –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É –∏ –∑–∞—ç–Ω—Å–µ–º–±–ª–∏—Ç—å.

---

## 6. Distribution alignment / –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞

*–û—Å—Ç–æ—Ä–æ–∂–Ω—ã–π, –Ω–æ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω–æ-–ø–æ–ø—É–ª—è—Ä–Ω—ã–π –±–ª–æ–∫, –∑–∞–≤–∏—Å—è—â–∏–π –æ—Ç –ø—Ä–∞–≤–∏–ª —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è.*

1. **Align —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ —Ç–∞—Ä–≥–µ—Ç–∞:**

   * –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ train –∏ test –∏–∑ –ø–æ—Ö–æ–∂–µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –º–æ–∂–Ω–æ:

     * –æ—Ç—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å pred –Ω–∞ —Ç–µ—Å—Ç–µ,
     * —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–Ω–≥–∏ –∫–≤–∞–Ω—Ç–∏–ª—è–º train-—Ç–∞—Ä–≥–µ—Ç–∞ (–∏–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–∞—Ä–≥–µ—Ç–∞).
   * –ë–æ–ª–µ–µ –º—è–≥–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –ø–æ–¥–æ–≥–Ω–∞—Ç—å –ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è mean/std –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å train-—Ç–∞—Ä–≥–µ—Ç–æ–º.

2. **–õ–æ–∫–∞–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º:**

   * –î–µ–ª–∏—à—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∫–æ–º—É-—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫—É (–∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ä–µ–≥–∏–æ–Ω, –∏ —Ç.–ø.).
   * –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ–¥–≥–æ–Ω—è–µ—à—å `a_segment` –∏ `b_segment` –≤ `y_true = a * y_pred + b` –ø–æ OOF.
   * –ù–∞ —Ç–µ—Å—Ç–µ –∫ –æ–±—ä–µ–∫—Ç—É –ø—Ä–∏–º–µ–Ω—è–µ—à—å –∫–∞–ª–∏–±—Ä–æ–≤–∫—É —Ç–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ–Ω –æ—Ç–Ω–æ—Å–∏—Ç—Å—è.

---

## 7. Semi-supervised / pseudo-labeling (–µ—Å–ª–∏ –µ—Å—Ç—å –º–Ω–æ–≥–æ –±–µ–∑–ª–µ–π–±–ª–æ–≤—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫/—Ç–∞–±–ª–∏—á–∫–∏)

1. –¢—Ä–µ–Ω–∏—Ä—É–µ—à—å —Å–∏–ª—å–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å –Ω–∞ –ª–µ–π–±–ª–µ–Ω–Ω–æ–º —Ç—Ä–µ–π–Ω-—Å–µ—Ç–µ.
2. –î–µ–ª–∞–µ—à—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ **–Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö** –æ–±—ä–µ–∫—Ç–æ–≤.
3. –û—Ç–±–∏—Ä–∞–µ—à—å –æ–±—ä–µ–∫—Ç—ã, –≥–¥–µ –º–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–∞ (–Ω–∏–∑–∫–∏–π –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–π —Ä–∞–∑–±—Ä–æ—Å –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º –º–æ–¥–µ–ª—è–º –∞–Ω—Å–∞–º–±–ª—è, –º–∞–ª–µ–Ω—å–∫–∏–π MSE –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏).
4. –î–æ–±–∞–≤–ª—è–µ—à—å —ç—Ç–∏ –ø—Å–µ–≤–¥–æ-–ª–µ–π–±–ª—ã –≤ train (—Å –º–µ–Ω—å—à–∏–º –≤–µ—Å–æ–º) –∏ –¥–æ–æ–±—É—á–∞–µ—à—å –º–æ–¥–µ–ª—å.

---

## –ß—Ç–æ –±—ã —è –¥–µ–ª–∞–ª –ø–æ —à–∞–≥–∞–º (—Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ä–æ–∞–¥–º–∞–ø)

1. **–ñ—ë—Å—Ç–∫–æ –æ—Ç–ª–∞–¥–∏—Ç—å CV** (Group + stratified –ø–æ –±–∏–Ω–∞–º).
2. **–ü—Ä–æ—Ç—é–Ω–∏–Ω–≥–æ–≤–∞—Ç—å CatBoost** —Å:

   * —Ñ–∏—á–∞–º–∏ `mean/max/std` —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤,
   * –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —ç–º–±–µ–¥–¥–µ—Ä–∞–º–∏,
   * –ø—Ä–æ—Å—Ç—ã–º–∏ –∫–∞—Ä—Ç–∏–Ω–∫–æ-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏.
3. **–°–¥–µ–ª–∞—Ç—å –º–Ω–æ–≥–æ-–º–æ–¥–µ–ª—å–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å**: CatBoost + LGBM + NN.
4. **–í–≤–µ—Å—Ç–∏ stacking** –Ω–∞ OOF-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö.
5. **–£—Å–ª–æ–∂–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏**:

   * TTA –Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–µ,
   * attention-–ø—É–ª–∏–Ω–≥ –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º,
   * finetune image-encoder –ø–æ–¥ —Ç–∞—Ä–≥–µ—Ç.
6. **–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞**: –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø—Ä–µ–¥–∏–∫—Ç–æ–≤ –∏, –µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ, –ª–µ–≥–∫–∏–π distribution alignment.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–≥—É –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π ¬´–ø–ª–∞–Ω —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤¬ª (—Å–ø–∏—Å–∫–æ–º, —á—Ç–æ –¥–µ–ª–∞—Ç—å –∫–∞–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1, 2, 3‚Ä¶ —Å –ø—Ä–∏–∫–∏–¥–∫–æ–π, –≥–¥–µ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø—Ä–∏—Ä–æ—Å—Ç–∞).